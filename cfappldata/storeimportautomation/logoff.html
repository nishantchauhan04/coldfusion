<cfif StructKeyExists(session, "cfid") AND (NOT StructKeyExists(cookie, "cfid") OR NOT StructKeyExists(cookie, "cftoken"))>
  <cfcookie name="cfid" value="#session.cfid#" />
  <cfcookie name="cftoken" value="#session.cftoken#" />
</cfif>

<cfloop collection="#session#" item="var">
    <cfset StructDelete(session, var)>
</cfloop>

<cfcookie name="CFID" expires="now">
<cfcookie name="CFTOKEN" expires="now">

<cflocation url="#application.logoffUrl#">